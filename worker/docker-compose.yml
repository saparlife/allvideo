version: '3.8'

services:
  worker:
    build: .
    restart: unless-stopped
    environment:
      - SUPABASE_URL=${SUPABASE_URL}
      - SUPABASE_SERVICE_ROLE_KEY=${SUPABASE_SERVICE_ROLE_KEY}
      - R2_ACCOUNT_ID=${R2_ACCOUNT_ID}
      - R2_ACCESS_KEY_ID=${R2_ACCESS_KEY_ID}
      - R2_SECRET_ACCESS_KEY=${R2_SECRET_ACCESS_KEY}
      - R2_BUCKET=${R2_BUCKET}
      - R2_PUBLIC_URL=${R2_PUBLIC_URL}
      - WORKER_ID=${WORKER_ID:-worker-1}
      - POLL_INTERVAL=${POLL_INTERVAL:-10000}
      - TEMP_DIR=/tmp/allvideo
    volumes:
      - worker-temp:/tmp/allvideo

volumes:
  worker-temp:
