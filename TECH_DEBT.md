# Technical Debt ‚Äî stream.1app.to

> –û–±–Ω–æ–≤–ª–µ–Ω–æ: 2026-01-10

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ (P0)

### 1. ~~Rate Limiting –¥–ª—è API~~ ‚Äî –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
–†–µ—à–µ–Ω–æ: –î–ª—è B2B API —Å –æ–¥–Ω–∏–º –∫–ª—é—á–æ–º –Ω–∞ –º–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ rate limiting –Ω–µ—Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–µ–Ω.

### 2. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ upload ‚úÖ
**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- [x] –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –ø–æ —Ç–∞—Ä–∏—Ñ—É (500MB free ‚Üí 100GB ultimate)
- [x] –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤ (path traversal, null bytes, —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã)
- [x] –í—Å–µ API routes –æ–±–Ω–æ–≤–ª–µ–Ω—ã

**–§–∞–π–ª—ã:**
- `src/lib/validation/file.ts` ‚Äî —Ñ—É–Ω–∫—Ü–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- `src/app/api/v1/*/route.ts` ‚Äî –≤—Å–µ upload endpoints

### 3. Health Check Endpoint ‚úÖ
**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- [x] `GET /api/health` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ë–î, uptime
- [x] `GET /api/health/worker` ‚Äî —Å—Ç–∞—Ç—É—Å worker, –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á

**–§–∞–π–ª—ã:**
- `src/app/api/health/route.ts`
- `src/app/api/health/worker/route.ts`

### 4. Graceful Shutdown –¥–ª—è Worker ‚úÖ
**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ SIGTERM/SIGINT
- [x] –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ job –ø–µ—Ä–µ–¥ –æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π
- [x] Release stuck jobs –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ uncaughtException

**–§–∞–π–ª—ã:**
- `worker/src/index.ts`
- `worker/src/supabase.ts` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω `releaseJob()`

### 5. Environment Variables Validation ‚úÖ
**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö env vars –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ (Next.js)
- [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ env vars –¥–ª—è Worker
- [x] –ü–æ–Ω—è—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏ –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

**–§–∞–π–ª—ã:**
- `src/lib/env.ts`
- `worker/src/config.ts`

### 6. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è CLAUDE.md ‚úÖ
**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- [x] –ü—Ä–∞–≤–∏–ª–∞ —è–∑—ã–∫–∞ –∏ git push
- [x] –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ TypeScript
- [x] –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫
- [x] API Structure
- [x] –ö–æ–º–∞–Ω–¥—ã –∏ —á–∞—Å—Ç—ã–µ –∑–∞–¥–∞—á–∏

---

## üü° –í–∞–∂–Ω–æ (P1) ‚Äî 14-18 —á–∞—Å–æ–≤

### 7. –¢–∏–ø–∏–∑–∞—Ü–∏—è Supabase
**–í—Ä–µ–º—è: 3-4 —á–∞—Å–∞**

- [ ] `npx supabase gen types typescript`
- [ ] –£–¥–∞–ª–∏—Ç—å –≤—Å–µ `as any` –∫–∞—Å—Ç—ã (~40 –º–µ—Å—Ç)
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ö–µ–º—ã

### 8. Webhook Retry Logic
**–í—Ä–µ–º—è: 3-4 —á–∞—Å–∞**

- [ ] Exponential backoff (1s, 2s, 4s, 8s, 16s)
- [ ] –ú–∞–∫—Å–∏–º—É–º 5 –ø–æ–ø—ã—Ç–æ–∫
- [ ] –°—Ç–∞—Ç—É—Å –¥–æ—Å—Ç–∞–≤–∫–∏ –≤ `webhook_deliveries`
- [ ] UI –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ failed deliveries

### 9. API Middleware Refactoring
**–í—Ä–µ–º—è: 4-5 —á–∞—Å–æ–≤**

- [ ] –í—ã–Ω–µ—Å—Ç–∏ –æ–±—â—É—é –ª–æ–≥–∏–∫—É –≤ middleware:
  - Auth –ø—Ä–æ–≤–µ—Ä–∫–∞
  - Storage limit –ø—Ä–æ–≤–µ—Ä–∫–∞
  - Error handling
- [ ] –£–º–µ–Ω—å—à–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ route handlers
- [ ] –°–æ–∑–¥–∞—Ç—å `handleRoute()` –ø–∞—Ç—Ç–µ—Ä–Ω –∫–∞–∫ –≤ LovSell

### 10. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
**–í—Ä–µ–º—è: 4-5 —á–∞—Å–æ–≤**

- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Sentry –¥–ª—è –æ—à–∏–±–æ–∫
- [ ] Structured logging (JSON —Ñ–æ—Ä–º–∞—Ç)
- [ ] –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö —Ç—Ä–∞–Ω—Å–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üü¢ –£–ª—É—á—à–µ–Ω–∏—è (P2) ‚Äî 14-18 —á–∞—Å–æ–≤

### 11. –¢–µ—Å—Ç—ã
**–í—Ä–µ–º—è: 6-8 —á–∞—Å–æ–≤**

- [ ] Unit —Ç–µ—Å—Ç—ã –¥–ª—è `lib/` —Ñ—É–Ω–∫—Ü–∏–π
- [ ] Integration —Ç–µ—Å—Ç—ã –¥–ª—è API endpoints
- [ ] E2E —Ç–µ—Å—Ç upload ‚Üí transcode ‚Üí play flow
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Vitest

### 12. CI/CD Pipeline
**–í—Ä–µ–º—è: 3-4 —á–∞—Å–∞**

- [ ] GitHub Actions workflow
- [ ] Lint + Type check –Ω–∞ PR
- [ ] –ê–≤—Ç–æ–¥–µ–ø–ª–æ–π –Ω–∞ Vercel –ø—Ä–∏ merge –≤ main
- [ ] Worker deploy script

### 13. –£–ª—É—á—à–µ–Ω–∏–µ Video Player
**–í—Ä–µ–º—è: 3-4 —á–∞—Å–∞**

- [ ] –ö–Ω–æ–ø–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—á–µ—Å—Ç–≤–∞ (360p/480p/720p/1080p)
- [ ] –°–∫–æ—Ä–æ—Å—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è (0.5x - 2x)
- [ ] Keyboard shortcuts (space, arrows)

### 14. Upload Progress
**–í—Ä–µ–º—è: 2-3 —á–∞—Å–∞**

- [ ] XMLHttpRequest —Å onprogress –¥–ª—è –ø–æ–∫–∞–∑–∞ %
- [ ] Cancel upload

---

## üîµ Nice to Have (P3) ‚Äî 10+ —á–∞—Å–æ–≤

### 15. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É videos ‚Üí media
**–í—Ä–µ–º—è: 2-3 —á–∞—Å–∞**

### 16. API Response Caching
**–í—Ä–µ–º—è: 2-3 —á–∞—Å–∞**

### 17. SDK —É–ª—É—á—à–µ–Ω–∏—è
**–í—Ä–µ–º—è: 3-4 —á–∞—Å–∞**

### 18. Dashboard —É–ª—É—á—à–µ–Ω–∏—è
**–í—Ä–µ–º—è: 3-4 —á–∞—Å–∞**

### 19. Service Layer (–∫–∞–∫ –≤ LovSell)
**–í—Ä–µ–º—è: 4-6 —á–∞—Å–æ–≤**

- [ ] –°–æ–∑–¥–∞—Ç—å `src/lib/services/` —Å—Ç—Ä—É–∫—Ç—É—Ä—É
- [ ] –í—ã–Ω–µ—Å—Ç–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –∏–∑ routes –≤ —Å–µ—Ä–≤–∏—Å—ã
- [ ] BaseService —Å –æ–±—â–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏

### 20. Zod Validation Schemas
**–í—Ä–µ–º—è: 2-3 —á–∞—Å–∞**

- [ ] –°–æ–∑–¥–∞—Ç—å `src/lib/validations/` —Å—Ç—Ä—É–∫—Ç—É—Ä—É
- [ ] Zod —Å—Ö–µ–º—ã –¥–ª—è –≤—Å–µ—Ö API inputs
- [ ] –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å—Ö–µ–º—ã

---

## Quick Wins (< 1 —á–∞—Å –∫–∞–∂–¥—ã–π)

- [ ] –î–æ–±–∞–≤–∏—Ç—å `robots.txt` –∏ `sitemap.xml`
- [ ] Meta tags –¥–ª—è SEO –Ω–∞ –ª–µ–Ω–¥–∏–Ω–≥–µ
- [ ] 404 —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –¥–∏–∑–∞–π–Ω–æ–º
- [ ] Loading skeleton –¥–ª—è —Å–ø–∏—Å–∫–æ–≤

---

## –ö–æ–º–∞–Ω–¥—ã

```bash
# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–∏–ø—ã Supabase
npx supabase gen types typescript --project-id vwuacajbigybmqonneou > src/types/supabase.ts

# –î–æ–±–∞–≤–∏—Ç—å Sentry
npm install @sentry/nextjs
npx @sentry/wizard@latest -i nextjs

# –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã
npm install -D vitest @testing-library/react

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å health
curl https://stream.1app.to/api/health
curl https://stream.1app.to/api/health/worker
```

---

## –ü—Ä–æ–≥—Ä–µ—Å—Å

| –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –í—Å–µ–≥–æ | –ì–æ—Ç–æ–≤–æ | % |
|-----------|-------|--------|---|
| P0 | 6 | 6 | 100% |
| P1 | 4 | 0 | 0% |
| P2 | 4 | 0 | 0% |
| P3 | 6 | 0 | 0% |
| Quick Wins | 4 | 0 | 0% |
